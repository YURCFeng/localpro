"use strict";(self["webpackChunkgeoview"]=self["webpackChunkgeoview"]||[]).push([[281],{9532:function(e,i,l){l.r(i),l.d(i,{default:function(){return J}});var s=l(3396),t=l(7139);const o=e=>((0,s.dD)("data-v-52999514"),e=e(),(0,s.Cn)(),e),a=o((()=>(0,s._)("div",{id:"sub-title"},[(0,s.Uk)(" 图像复原"),(0,s._)("i",{class:"iconfont icon-dianji"})],-1))),n=(0,s.uE)('<p data-v-52999514> 请上传包含<span class="go-bold" data-v-52999514>图片的文件夹</span><i class="iconfont icon-wenjianjia" data-v-52999514></i>或者<span class="go-bold" data-v-52999514>图片</span><i class="iconfont icon-tupiantianjia" data-v-52999514></i>，<i class="iconfont icon-zidingyi" data-v-52999514></i>自定义模型文件请上传至<span class="go-bold" data-v-52999514>backend/model文件夹</span><i class="iconfont icon-wenjianjia" data-v-52999514></i>下的<span class="go-bold" data-v-52999514>image_restoration文件夹</span></p>',1),d={key:0,class:"clear-queue"},r=o((()=>(0,s._)("i",{class:"iconfont icon-yunduanshangchuan"},null,-1))),c=o((()=>(0,s._)("div",{class:"el-upload__text"},[(0,s.Uk)(" 将文件拖到此处，或"),(0,s._)("em",null,"点击上传")],-1))),u=o((()=>(0,s._)("div",{class:"el-upload__tip"}," 只能上传一张或多张图片，请在下方上传文件夹 ",-1))),p={class:"prehandle-label container"},h=o((()=>(0,s._)("span",{class:"checkmark"},null,-1))),m=o((()=>(0,s._)("span",{class:"go-bold label-words"},"上传时编辑图片",-1))),g=o((()=>(0,s._)("i",{class:"iconfont icon-crop-full"},null,-1))),f={class:"custom-model"},_={key:0},w={class:"handle-button"},k=o((()=>(0,s._)("div",{id:"sub-title"},[(0,s.Uk)(" 结果图预览"),(0,s._)("i",{class:"iconfont icon-dianji"})],-1))),b=o((()=>(0,s._)("p",null,[(0,s._)("span",{class:"go-bold"},"点击图片"),(0,s.Uk)("即可预览 "),(0,s._)("i",{class:"iconfont icon-duigou"}),(0,s._)("span",null,[(0,s._)("span",{class:"go-bold"},"滑轮滚动"),(0,s.Uk)("即可放大缩小")])],-1))),v={class:"go-bold"},y=o((()=>(0,s._)("span",{class:"hidden-sm-and-down"},"点击刷新",-1))),C=[y],U={class:"restore-img-box"},M=["src"],S={class:"img-wrapper"},W=["src"],x=o((()=>(0,s._)("div",{class:"handle"},[(0,s._)("div",{class:"handle-line"}),(0,s._)("div",{class:"handle-circle"}," «» "),(0,s._)("div",{class:"handle-line"})],-1))),L={class:"choose-restore"},j=o((()=>(0,s._)("div",{class:"style-title"}," 选择图片 ",-1))),A={key:1},D=["onClick"],I={style:{"text-align":"center"}},V={style:{"text-align":"center"}};function T(e,i,l,o,y,T){const R=(0,s.up)("Tabinfor"),P=(0,s.up)("el-divider"),$=(0,s.up)("el-button"),q=(0,s.up)("el-upload"),z=(0,s.up)("el-row"),Q=(0,s.up)("el-radio"),E=(0,s.up)("el-card"),G=(0,s.up)("el-col"),F=(0,s.up)("MyVueCropper"),B=(0,s.up)("el-dialog"),J=(0,s.up)("el-empty"),Z=(0,s.up)("el-image"),H=(0,s.up)("Bottominfor");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(R,null,{left:(0,s.w5)((()=>[a])),_:1}),(0,s.Wm)(P),n,(0,s.Wm)(z,{type:"flex",justify:"center"},{default:(0,s.w5)((()=>[(0,s.Wm)(G,{span:24},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{style:{border:"4px dashed var(--el-border-color)"}},{default:(0,s.w5)((()=>[y.fileList.length?((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)($,{type:"primary",class:"btn-animate2 btn-animate__surround",onClick:T.clearQueue},{default:(0,s.w5)((()=>[(0,s.Uk)(" 清空图片 ")])),_:1},8,["onClick"])])):(0,s.kq)("",!0),(0,s.Wm)(q,{ref:"upload","file-list":y.fileList,"onUpdate:fileList":i[0]||(i[0]=e=>y.fileList=e),class:"upload-card",drag:"",action:"#",multiple:"","auto-upload":!1,onChange:i[1]||(i[1]=e=>T.beforeUpload(y.fileList[y.fileList.length-1].raw))},{default:(0,s.w5)((()=>[r,c,u])),_:1},8,["file-list"]),(0,s.Wm)(z,{justify:"center"},{default:(0,s.w5)((()=>[(0,s._)("input",{id:"folder",ref:"uploadFile",type:"file",webkitdirectory:"",directory:"",multiple:"",onChange:i[2]||(i[2]=e=>T.uploadMore())},null,544),(0,s._)("i",{class:"iconfont icon-wenjianshangchuan",onClick:i[3]||(i[3]=(...e)=>T.fileClick&&T.fileClick(...e))},"上传文件夹")])),_:1}),(0,s.Wm)(z,{justify:"center"},{default:(0,s.w5)((()=>[(0,s._)("p",null,[(0,s._)("label",p,[(0,s._)("input",{ref:"cut",type:"checkbox",onChange:i[4]||(i[4]=e=>T.select())},null,544),h,m,g])])])),_:1}),(0,s.Wm)(z,{justify:"center"},{default:(0,s.w5)((()=>[(0,s._)("div",f,[(0,s.Uk)(" 可选训练模型： "),0===y.modelPathArr.length?((0,s.wg)(),(0,s.iD)("span",_,"未检测到模型文件，请查看上传目录是否有误")):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(y.modelPathArr,((e,l)=>((0,s.wg)(),(0,s.j4)(Q,{key:l,modelValue:y.uploadSrc.model_path,"onUpdate:modelValue":i[5]||(i[5]=e=>y.uploadSrc.model_path=e),class:"choose-item",label:e.model_path},{default:(0,s.w5)((()=>[(0,s.Uk)((0,t.zw)(e.model_name),1)])),_:2},1032,["modelValue","label"])))),128))])])),_:1}),(0,s._)("div",w,[(0,s.Wm)($,{type:"primary",class:"btn-animate btn-animate__shiny",onClick:i[6]||(i[6]=e=>T.upload("图像复原","image_restoration"))},{default:(0,s.w5)((()=>[(0,s.Uk)(" 开始处理 ")])),_:1})])])),_:1})])),_:1})])),_:1}),(0,s.Wm)(R,null,{left:(0,s.w5)((()=>[k])),_:1}),(0,s.Wm)(P),(0,s.Wm)(R,null,{left:(0,s.w5)((()=>[b])),right:(0,s.w5)((()=>[(0,s._)("span",v,[(0,s._)("i",{class:"iconfont icon-shuaxin",style:{"padding-right":"55px"},onClick:i[7]||(i[7]=(...e)=>T.getMore&&T.getMore(...e))},C)])])),_:1}),(0,s.Wm)(B,{modelValue:y.cutVisible,"onUpdate:modelValue":i[8]||(i[8]=e=>y.cutVisible=e),modal:!1,title:"编辑",width:"75%",top:"0"},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{fileimg:y.fileimg,funtype:y.funtype,file:y.file,child_prehandle:y.uploadSrc.prehandle,child_denoise:y.uploadSrc.denoise,"child-model-path":y.uploadSrc.model_path,onCutChanged:T.notvisible,onChildRefresh:T.getMore},null,8,["fileimg","funtype","file","child_prehandle","child_denoise","child-model-path","onCutChanged","onChildRefresh"])])),_:1},8,["modelValue"]),(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s._)("div",U,[(0,s._)("div",null,[y.isUpload?((0,s.wg)(),(0,s.iD)("div",{key:1,id:"image-slider",onMousemove:i[9]||(i[9]=(...e)=>T.sliderMouseMove&&T.sliderMouseMove(...e)),onMousedown:i[10]||(i[10]=(...e)=>T.sliderMouseDown&&T.sliderMouseDown(...e)),onMouseup:i[11]||(i[11]=(...e)=>T.sliderMouseUp&&T.sliderMouseUp(...e)),onMouseleave:i[12]||(i[12]=(...e)=>T.sliderMouseLeave&&T.sliderMouseLeave(...e))},[(0,s._)("img",{src:y.imgArr[y.currentIndex]?.before_img,alt:""},null,8,M),(0,s._)("div",S,[(0,s._)("img",{src:y.imgArr[y.currentIndex]?.after_img,alt:""},null,8,W)]),x],32)):((0,s.wg)(),(0,s.j4)(J,{key:0,"image-size":300}))]),(0,s._)("div",L,[(0,s.Wm)(P,{style:{"margin-top":"0"}}),j,y.isUpload?((0,s.wg)(),(0,s.iD)("div",A,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Math.ceil(y.imgArr.length/5),((e,i)=>((0,s.wg)(),(0,s.iD)("div",{key:i,class:"list"},[(0,s._)("div",{class:"list-number",onClick:e=>T.goShowThese(i)},(0,t.zw)(5*i+1)+"-----"+(0,t.zw)(5*(i+1)),9,D)])))),128)),(0,s._)("div",I,[(0,s.Uk)(" 下载此图片："),(0,s.Wm)($,{type:"primary",style:{width:"60px"},class:"btn-animate btn-animate__shiny",onClick:i[13]||(i[13]=e=>T.downloadimgWithWords(y.imgArr[y.currentIndex].id,y.imgArr[y.currentIndex].after_img,"图像复原结果图.png"))},{default:(0,s.w5)((()=>[(0,s.Uk)(" 下载 ")])),_:1}),(0,s._)("p",V,[(0,s._)("span",null,[(0,s._)("i",{class:"iconfont icon-dabaoxiazai",onClick:i[14]||(i[14]=e=>T.goCompress("图像复原"))},"所有结果图打包")])])])])):((0,s.wg)(),(0,s.j4)(J,{key:0,"image-size":100}))])]),(0,s.Wm)(z,{class:"swiper-img"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(5,((e,i)=>(0,s._)("div",{key:i,class:"img-box"},[y.imgArr[y.currentQroup+i]?.after_img?((0,s.wg)(),(0,s.j4)(Z,{key:0,src:y.imgArr[y.currentQroup+i]?.after_img,class:(0,t.C_)({"render-border":y.onRender===i}),onClick:e=>T.goShowThis(i)},null,8,["src","class","onClick"])):(0,s.kq)("",!0)]))),64))])),_:1})])),_:1}),(0,s.Wm)(H)])}l(7658);var R=l(8692),P=l(9450),$=l(2239),q=l(5893),z=l(4314),Q=l(2606),E=l(410),G={name:"Restoreimgs",components:{Tabinfor:z.Z,Bottominfor:Q.Z,MyVueCropper:E.Z},beforeRouteEnter(e,i,l){l((e=>{document.querySelector(".el-main").scrollTop=0}))},data(){return{canUpload:!0,fileimg:"",file:{},isNotCut:!0,cutVisible:!1,funtype:"图像复原",scrollTop:"",fit:"fill",fileList:[],uploadSrc:{list:[],model_path:""},modelPathArr:[],isSliderLocked:!1,onRender:0,currentIndex:0,currentQroup:0,imgArr:[],isUpload:!1}},watch:{uploadSrc:{handler(e,i){this.uploadSrc=e},deep:!0,immediate:!0},isUpload:{handler(e,i){this.isUpload=e}}},created(){this.getUploadImg("图像复原"),this.getCustomModel("image_restoration").then((e=>{this.modelPathArr=e.data.data,this.uploadSrc.model_path=this.modelPathArr[0]?.model_path})).catch((e=>{}))},methods:{imgUpload:R.cM,getCustomModel:R.Xk,historyGetPage:P.G,createSrc:R.EE,getUploadImg:$.sw,upload:$.ws,downloadimgWithWords:q.R3,getImgArrayBuffer:q.pT,atchDownload:q.wR,goCompress:$.XA,clearQueue(){this.fileList=[],this.$message.success("清除成功")},notvisible(){this.cutVisible=!1,this.fileList=[]},getMore(){this.getUploadImg("图像复原"),this.goShowThese(0),console.log(this.imgArr.length)},uploadMore(){this.beforeUpload(...this.$refs.uploadFile.files),this.canUpload?this.fileList.push(...this.$refs.uploadFile.files):setTimeout((()=>{this.$message.error("检测到您上传的文件夹内存在不符合规范的图片类型")}),1e3)},fileClick(){document.querySelector("#folder").click()},beforeUpload(e){this.cutVisible=this.$refs.cut.checked;const i=e.name.substring(e.name.lastIndexOf(".")+1),l=["jpg","jpeg","png","JPG","JPEG"];-1===l.indexOf(i)?(this.$message.error("只允许上传jpg, jpeg, png, JPG, 或JPEG格式,请重新上传"),this.fileList=[],this.canUpload=!1,this.cutVisible=!1):(this.canUpload=!0,this.fileimg=window.URL.createObjectURL(new Blob([e])))},select(){this.isNotCut=this.$refs.cut.checked},goShowThis(e){this.currentIndex=this.currentQroup,this.currentIndex+=e,this.onRender=e},goShowThese(e){this.currentQroup=5*e,this.currentIndex=5*e,this.goShowThis(0)},sliderMouseMove(e){const i=document.querySelector("#image-slider"),l=document.querySelector(".img-wrapper"),s=document.querySelector(".handle");if(this.isSliderLocked)return;const t=i.offsetLeft,o=i.clientWidth,a=s.clientWidth;let n=e.clientX-t;n<0?n=0:n>o&&(n=o),l.style.width=`${(100*(1-n/o)).toFixed(4)}%`,s.style.left=`calc(${(n/o*100).toFixed(4)}% - ${a/2}px)`},sliderMouseDown(){this.isSliderLocked&&(this.isSliderLocked=!1),this.sliderMouseMove(event)},sliderMouseUp(){this.isSliderLocked||(this.isSliderLocked=!0)},sliderMouseLeave(){this.isSliderLocked&&(this.isSliderLocked=!0)}}},F=l(89);const B=(0,F.Z)(G,[["render",T],["__scopeId","data-v-52999514"]]);var J=B}}]);
//# sourceMappingURL=281.788f6a70.js.map